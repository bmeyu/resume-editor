<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½ç®€å†ç¼–è¾‘å™¨ - å¸¦ç…§ç‰‡ä¸Šä¼ åŠŸèƒ½</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --text-dark: #333333;
            --text-light: #666666;
            --bg-light: #f8fafc;
            --border-color: #e2e8f0;
            --toolbar-bg: #ffffff;
            --shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        [data-theme="dark"] {
            --text-dark: #e2e8f0;
            --text-light: #94a3b8;
            --bg-light: #1e293b;
            --border-color: #334155;
            --toolbar-bg: #0f172a;
            --shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'PingFang SC', system-ui, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--bg-light);
            transition: background 0.3s;
            padding: 20px;
            min-height: 100vh;
            background-image: linear-gradient(135deg, #f5f7fa 0%, #e4e7eb 100%);
        }
        
        [data-theme="dark"] body {
            background-image: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 25px;
        }
        
        /* æ§åˆ¶é¢æ¿æ ·å¼ */
        .control-panel {
            background: var(--toolbar-bg);
            border-radius: 12px;
            padding: 25px;
            box-shadow: var(--shadow);
            height: fit-content;
            position: sticky;
            top: 20px;
        }
        
        .panel-title {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .panel-title i {
            font-size: 1.2rem;
        }
        
        .control-group {
            margin-bottom: 25px;
        }
        
        .control-group h3 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-group h3 i {
            color: var(--primary-color);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(37, 99, 235, 0.3);
        }
        
        .btn i {
            font-size: 1.1rem;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }
        
        .btn-outline:hover {
            background: rgba(37, 99, 235, 0.1);
        }
        
        .color-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
            border: 2px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.active {
            transform: scale(1.15);
            border: 2px solid var(--text-dark);
            box-shadow: 0 0 0 3px var(--primary-color);
        }
        
        .theme-toggle {
            background: var(--toolbar-bg);
            border: 1px solid var(--border-color);
            display: flex;
            border-radius: 50px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .theme-btn {
            flex: 1;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .theme-btn.active {
            background: var(--primary-color);
            color: white;
        }
        
        .export-options {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .export-options .btn {
            flex: 1;
        }
        
        /* ç®€å†ç¼–è¾‘åŒºåŸŸ */
        .resume-container {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s;
            min-height: 100vh;
            position: relative;
        }
        
        [data-theme="dark"] .resume-container {
            background: #0f172a;
        }
        
        .resume-content {
            padding: 40px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* ç…§ç‰‡ä¸Šä¼ åŒºåŸŸ */
        .photo-container {
            position: absolute;
            top: 40px;
            right: 40px;
            width: 140px;
            height: 180px;
            border: 1px dashed var(--border-color);
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: #f9fafb;
            z-index: 10;
        }
        
        .photo-preview {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-size: cover;
            background-position: center;
        }
        
        .photo-placeholder {
            text-align: center;
            padding: 20px;
            color: var(--text-light);
        }
        
        .photo-placeholder i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .photo-actions {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.5);
            padding: 8px;
            display: flex;
            justify-content: center;
            gap: 10px;
            transform: translateY(100%);
            transition: transform 0.3s;
        }
        
        .photo-container:hover .photo-actions {
            transform: translateY(0);
        }
        
        .photo-btn {
            background: rgba(255,255,255,0.9);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-dark);
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .photo-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        /* ç®€å†å¤´éƒ¨æ ·å¼ */
        header {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 20px;
            position: relative;
        }
        
        h1 {
            font-size: 2.4rem;
            margin-bottom: 0.25rem;
            color: var(--primary-color);
            outline: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        h1:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        .job-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 1.5rem;
            outline: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .job-title:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        .contact {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1.5rem;
            margin-top: 0.5rem;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            outline: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        .contact-item:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        /* æ¨¡å—é€šç”¨æ ·å¼ */
        section {
            margin-bottom: 2.5rem;
            border-bottom: 1px dashed var(--border-color);
            padding-bottom: 1.8rem;
        }
        
        h2 {
            font-size: 1.5rem;
            border-left: 4px solid var(--primary-color);
            padding-left: 1rem;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .add-btn {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-color);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }
        
        .add-btn:hover {
            background: var(--primary-color);
            color: white;
        }
        
        /* æ‘˜è¦æ ·å¼ */
        .summary {
            background: rgba(37, 99, 235, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            font-size: 1.05rem;
            outline: none;
            line-height: 1.7;
            min-height: 100px;
            transition: all 0.2s;
        }
        
        .summary:focus {
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
            background: rgba(37, 99, 235, 0.08);
        }
        
        /* ç»å†æ¡ç›®æ ·å¼ */
        .experience-item, .project-item {
            margin-bottom: 2rem;
            background: rgba(37, 99, 235, 0.03);
            border-radius: 8px;
            padding: 1.2rem;
            transition: all 0.2s;
            position: relative;
        }
        
        .experience-item:focus-within, .project-item:focus-within {
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
            background: rgba(37, 99, 235, 0.05);
        }
        
        .item-header {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 0.5rem;
            gap: 10px;
        }
        
        .company, .project-name {
            font-weight: 600;
            font-size: 1.15rem;
            outline: none;
            padding: 3px 6px;
            border-radius: 4px;
            flex: 1;
        }
        
        .company:focus, .project-name:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        .date {
            color: var(--text-light);
            font-size: 0.95rem;
            outline: none;
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .date:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        .position {
            font-style: italic;
            margin-bottom: 0.8rem;
            color: var(--text-light);
            outline: none;
            padding: 3px 6px;
            border-radius: 4px;
        }
        
        .position:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        ul {
            padding-left: 1.5rem;
        }
        
        li {
            margin-bottom: 0.6rem;
            position: relative;
            outline: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.2s;
        }
        
        li:focus {
            background: rgba(37, 99, 235, 0.05);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }
        
        li::before {
            content: "â—";
            color: var(--primary-color);
            position: absolute;
            left: -1.2rem;
            font-size: 0.8rem;
        }
        
        /* æŠ€èƒ½æ ·å¼ */
        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.8rem;
        }
        
        .skill-tag {
            background: rgba(37, 99, 235, 0.1);
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.95rem;
            outline: none;
            transition: all 0.2s;
        }
        
        .skill-tag:focus {
            background: rgba(37, 99, 235, 0.2);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.3);
        }

        .skill-tag span {
            outline: none;
        }

        .delete-tag-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            margin-left: 8px;
            font-size: 1.1rem;
            opacity: 0.6;
            transition: all 0.2s;
        }

        .skill-tag:hover .delete-tag-btn {
            opacity: 1;
        }

        .delete-tag-btn:hover {
            transform: scale(1.2);
            color: #dc2626; /* çº¢è‰²ä»¥ç¤ºå±é™©æ“ä½œ */
        }
        
        /* AIæç¤ºåŒºåŸŸ */
        .ai-tips {
            background: rgba(37, 99, 235, 0.05);
            border-left: 4px solid var(--primary-color);
            padding: 1.2rem;
            border-radius: 0 8px 8px 0;
            margin-top: 1.5rem;
            font-size: 0.95rem;
        }
        
        .ai-tips strong {
            color: var(--primary-color);
        }
        
        .ai-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
            padding: 8px 12px;
            background: rgba(37, 99, 235, 0.05);
            border-radius: 6px;
            cursor: pointer;
        }
        
        .ai-toggle input {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(220, 38, 38, 0.1);
            color: #dc2626;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .delete-btn:hover {
            background: #dc2626;
            color: white;
        }
        
        /* å“åº”å¼é€‚é… */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .control-panel {
                position: relative;
                top: 0;
            }
        }
        
        @media (max-width: 700px) {
            .resume-content {
                padding: 25px 15px;
            }
            
            .photo-container {
                position: relative;
                top: 0;
                right: 0;
                width: 120px;
                height: 160px;
                margin: 0 auto 20px;
            }
            
            .contact {
                gap: 0.8rem;
                justify-content: flex-start;
            }
            
            .item-header {
                flex-direction: column;
            }
            
            .date {
                margin-top: 0.2rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        /* é€šçŸ¥æ ·å¼ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateX(120%);
            transition: transform 0.3s ease-out;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
        <div class="control-panel">
            <h2 class="panel-title"><i class="fas fa-tools"></i> ç®€å†ç¼–è¾‘å™¨</h2>
            
            <div class="control-group">
                <h3><i class="fas fa-camera"></i> ç…§ç‰‡ä¸Šä¼ </h3>
                <div class="photo-upload">
                    <input type="file" id="photoUpload" accept="image/*" style="display: none;">
                    <button class="btn" id="uploadPhotoBtn">
                        <i class="fas fa-upload"></i> é€‰æ‹©ç…§ç‰‡
                    </button>
                    <div class="ai-toggle">
                        <input type="checkbox" id="showPhoto" checked>
                        <label for="showPhoto">åœ¨ç®€å†ä¸­æ˜¾ç¤ºç…§ç‰‡</label>
                    </div>
                </div>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-paint-brush"></i> ä¸»é¢˜é¢œè‰²</h3>
                <div class="color-options">
                    <div class="color-option active" style="background-color: #2563eb;" data-color="#2563eb"></div>
                    <div class="color-option" style="background-color: #0ea5e9;" data-color="#0ea5e9"></div>
                    <div class="color-option" style="background-color: #8b5cf6;" data-color="#8b5cf6"></div>
                    <div class="color-option" style="background-color: #ec4899;" data-color="#ec4899"></div>
                    <div class="color-option" style="background-color: #10b981;" data-color="#10b981"></div>
                    <div class="color-option" style="background-color: #f59e0b;" data-color="#f59e0b"></div>
                </div>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-moon"></i> é¢œè‰²æ¨¡å¼</h3>
                <div class="theme-toggle">
                    <div class="theme-btn active" data-theme="light">æµ…è‰²æ¨¡å¼</div>
                    <div class="theme-btn" data-theme="dark">æ·±è‰²æ¨¡å¼</div>
                </div>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-file-export"></i> å¯¼å‡ºé€‰é¡¹</h3>
                <div class="export-options">
                    <button class="btn" id="exportPdf">
                        <i class="fas fa-file-pdf"></i> å¯¼å‡ºPDF
                    </button>
                </div>
                <button class="btn btn-outline" id="saveLocal">
                    <i class="fas fa-save"></i> ä¿å­˜åˆ°æœ¬åœ°
                </button>
                <button class="btn btn-outline" id="loadLocal">
                    <i class="fas fa-folder-open"></i> ä»æœ¬åœ°åŠ è½½
                </button>
                <button class="btn btn-outline" id="resetTemplate" style="border-color: #f43f5e; color: #f43f5e;">
                    <i class="fas fa-sync-alt"></i> é‡ç½®ä¸ºæ¨¡æ¿
                </button>
            </div>

            <div class="control-group">
                <h3><i class="fas fa-briefcase"></i> æ™ºèƒ½åŒ¹é…</h3>
                <button class="btn" id="matchJobsBtn">
                    <i class="fas fa-search-plus"></i> æ™ºèƒ½åŒ¹é…å²—ä½
                </button>
                <div id="jobMatchResults" style="display: none; margin-top: 15px; padding: 15px; border: 1px solid var(--border-color); border-radius: 6px; position: relative;">
                    <button id="closeMatchResults" style="position: absolute; top: 5px; right: 10px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-light);">&times;</button>
                    <h4 style="margin-bottom: 10px;">åŒ¹é…ç»“æœ:</h4>
                    <a id="zhipinLink" href="#" target="_blank" style="display: block; padding: 10px; margin-bottom: 5px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 4px; text-align: center;">åœ¨BOSSç›´è˜ä¸ŠæŸ¥çœ‹</a>
                    <a id="liepinLink" href="#" target="_blank" style="display: block; padding: 10px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 4px; text-align: center;">åœ¨çŒè˜ç½‘ä¸ŠæŸ¥çœ‹</a>
                </div>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-robot"></i> AIæç¤ºè®¾ç½®</h3>
                <div class="ai-toggle">
                    <input type="checkbox" id="showAiTips" checked>
                    <label for="showAiTips">åœ¨ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºAIæç¤º</label>
                </div>
                <p style="color: var(--text-light); font-size: 0.9rem; margin-top: 10px;">
                    <i class="fas fa-info-circle"></i> AIæç¤ºä»…åœ¨ç¼–è¾‘æ—¶å¯è§ï¼Œå¯¼å‡ºPDFæ—¶è‡ªåŠ¨éšè—
                </p>
            </div>
            
            <div class="control-group">
                <h3><i class="fas fa-lightbulb"></i> ä½¿ç”¨æç¤º</h3>
                <ul style="color: var(--text-light); padding-left: 20px; font-size: 0.9rem;">
                    <li>ç‚¹å‡»ä»»ä½•æ–‡æœ¬åŒºåŸŸå¯ç›´æ¥ç¼–è¾‘å†…å®¹</li>
                    <li>ç…§ç‰‡å»ºè®®ä½¿ç”¨ä¸“ä¸šè¯ä»¶ç…§æˆ–å•†åŠ¡ç…§</li>
                    <li>åœ¨åŒ—ç¾æ±‚èŒé€šå¸¸ä¸æ”¾ç…§ç‰‡ï¼Œäºšæ´²/æ¬§æ´²å»ºè®®æ”¾</li>
                    <li>AIæç¤ºä»…ç”¨äºç¼–è¾‘å‚è€ƒï¼Œä¸ä¼šå‡ºç°åœ¨æœ€ç»ˆç®€å†</li>
                </ul>
            </div>
        </div>
        
        <!-- ç®€å†å†…å®¹åŒºåŸŸ -->
        <div class="resume-container" id="resumeContent">
            <div class="photo-container" id="photoContainer">
                <div class="photo-preview" id="photoPreview">
                    <div class="photo-placeholder">
                        <i class="fas fa-user-circle"></i>
                        <p>ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</p>
                    </div>
                </div>
                <div class="photo-actions">
                    <div class="photo-btn" id="changePhotoBtn">
                        <i class="fas fa-sync-alt"></i>
                    </div>
                    <div class="photo-btn" id="removePhotoBtn">
                        <i class="fas fa-trash-alt"></i>
                    </div>
                </div>
            </div>
            
            <div class="resume-content">
                <header>
                    <h1 contenteditable="true">å¼ æ˜</h1>
                    <div class="job-title" contenteditable="true">é«˜çº§äº§å“ç»ç† | ç”¨æˆ·å¢é•¿æ–¹å‘</div>
                    <div class="contact">
                        <div class="contact-item" contenteditable="true">ğŸ“± 13800138000</div>
                        <div class="contact-item" contenteditable="true">âœ‰ï¸ zhangming@email.com</div>
                        <div class="contact-item" contenteditable="true">ğŸ“ ä¸Šæµ· | åŒ—äº¬</div>
                        <div class="contact-item" contenteditable="true">ğŸ”— portfolio.com/zhangming</div>
                    </div>
                </header>

                <section id="summary">
                    <h2>èŒä¸šæ‘˜è¦</h2>
                    <div class="summary" contenteditable="true">
                        5å¹´äº’è”ç½‘äº§å“ç»éªŒï¼Œä¸“æ³¨ç”¨æˆ·å¢é•¿ä¸å•†ä¸šåŒ–è®¾è®¡ã€‚ä¸»å¯¼3æ¬¾ç™¾ä¸‡çº§DAUäº§å“è¿­ä»£ï¼Œæ›¾å®ç°30å¤©æ–°ç”¨æˆ·å¢é•¿120%ï¼Œä»˜è´¹è½¬åŒ–ç‡æå‡18%ã€‚æ“…é•¿æ•°æ®é©±åŠ¨å†³ç­–ä¸è·¨éƒ¨é—¨åä½œï¼Œè·2024å¹´åº¦å…¬å¸åˆ›æ–°å¥–ã€‚
                    </div>
                </section>

                <section id="experience">
                    <h2>
                        å·¥ä½œç»å†
                        <button class="add-btn" id="addExperience">+</button>
                    </h2>
                    
                    <div class="experience-item">
                        <button class="delete-btn">Ã—</button>
                        <div class="item-header">
                            <div class="company" contenteditable="true">è…¾è®¯ Â· å¾®ä¿¡äº‹ä¸šç¾¤</div>
                            <div class="date" contenteditable="true">2022å¹´6æœˆ - è‡³ä»Š</div>
                        </div>
                        <div class="position" contenteditable="true">é«˜çº§äº§å“ç»ç†ï¼ˆç”¨æˆ·å¢é•¿ï¼‰</div>
                        <ul>
                            <li contenteditable="true">é‡æ„æ–°ç”¨æˆ·å¼•å¯¼æµç¨‹ï¼Œé¦–å‘¨ç•™å­˜ç‡æå‡<span class="highlight">32%</span>ï¼Œè·å­£åº¦åˆ›æ–°é¡¹ç›®é‡‘å¥–</li>
                            <li contenteditable="true">è®¾è®¡ç¤¾äº¤è£‚å˜å¢é•¿æ¨¡å‹ï¼Œ3ä¸ªæœˆå¸¦æ¥<span class="highlight">180ä¸‡</span>æ–°å¢ç”¨æˆ·ï¼Œè·å®¢æˆæœ¬é™ä½<span class="highlight">40%</span></li>
                            <li contenteditable="true">ä¸»å¯¼ABå®éªŒå¹³å°å‡çº§ï¼Œå®éªŒè¿­ä»£æ•ˆç‡æå‡<span class="highlight">50%</span>ï¼Œæ”¯æŒæ—¥å‡20+å®éªŒå¹¶è¡Œ</li>
                        </ul>
                    </div>

                    <div class="experience-item">
                        <button class="delete-btn">Ã—</button>
                        <div class="item-header">
                            <div class="company" contenteditable="true">å­—èŠ‚è·³åŠ¨ Â· æŠ–éŸ³ç”µå•†</div>
                            <div class="date" contenteditable="true">2020å¹´3æœˆ - 2022å¹´5æœˆ</div>
                        </div>
                        <div class="position" contenteditable="true">äº§å“ç»ç†</div>
                        <ul>
                            <li contenteditable="true">è®¾è®¡ç›´æ’­è´­ç‰©è½¦ä¼˜åŒ–æ–¹æ¡ˆï¼Œä¸‹å•è½¬åŒ–ç‡æå‡<span class="highlight">22%</span>ï¼ŒGMVæœˆå¢<span class="highlight">1.2äº¿</span></li>
                            <li contenteditable="true">æ­å»ºå•†å®¶æˆé•¿ä½“ç³»ï¼Œä¼˜è´¨å•†å®¶ç•™å­˜ç‡æé«˜<span class="highlight">35%</span></li>
                        </ul>
                    </div>
                </section>

                <section id="education">
                    <h2>
                        æ•™è‚²ç»å†
                        <button class="add-btn" id="addEducation">+</button>
                    </h2>
                    <div class="experience-item">
                        <button class="delete-btn">Ã—</button>
                        <div class="item-header">
                            <div class="company" contenteditable="true">åŒ—äº¬å¤§å­¦</div>
                            <div class="date" contenteditable="true">2016å¹´9æœˆ - 2020å¹´6æœˆ</div>
                        </div>
                        <div class="position" contenteditable="true">ç¡•å£« Â· è®¡ç®—æœºç§‘å­¦</div>
                        <ul>
                            <li contenteditable="true">ä¸“ä¸šæ’åï¼šTop 5%</li>
                            <li contenteditable="true">è·å¾—å›½å®¶å¥–å­¦é‡‘ã€åŒ—äº¬å¸‚ä¼˜ç§€æ¯•ä¸šç”Ÿ</li>
                        </ul>
                    </div>
                </section>

                <section id="projects">
                    <h2>
                        å…³é”®é¡¹ç›®
                        <button class="add-btn" id="addProject">+</button>
                    </h2>
                    <div class="project-item">
                        <button class="delete-btn">Ã—</button>
                        <div class="item-header">
                            <div class="project-name" contenteditable="true">å¾®ä¿¡ã€Œè´­ç‰©åœˆã€ç¤¾äº¤ç”µå•†ä½“ç³»</div>
                            <div class="date" contenteditable="true">2023å¹´3æœˆ-2023å¹´10æœˆ</div>
                        </div>
                        <ul>
                            <li contenteditable="true">ä»0åˆ°1è®¾è®¡å¥½å‹æ‹¼å›¢ç³»ç»Ÿï¼Œä¸Šçº¿é¦–æœˆå¸¦åŠ¨<span class="highlight">86ä¸‡</span>ç¬”è®¢å•</li>
                            <li contenteditable="true">å»ºç«‹UGCå†…å®¹æ¿€åŠ±ä½“ç³»ï¼Œç”¨æˆ·å†…å®¹è´¡çŒ®é‡æå‡<span class="highlight">150%</span></li>
                        </ul>
                    </div>
                </section>

                <section id="skills">
                    <h2>
                        æŠ€èƒ½è¯ä¹¦
                        <button class="add-btn" id="addSkill">+</button>
                    </h2>
                    <div class="skills-container">
                        <div class="skill-tag"><span contenteditable="true">å¢é•¿é»‘å®¢æ–¹æ³•è®º</span><button class="delete-tag-btn">Ã—</button></div>
                        <div class="skill-tag"><span contenteditable="true">SQL/Pythonæ•°æ®åˆ†æ</span><button class="delete-tag-btn">Ã—</button></div>
                        <div class="skill-tag"><span contenteditable="true">ç”¨æˆ·è¡Œä¸ºåˆ†æ</span><button class="delete-tag-btn">Ã—</button></div>
                        <div class="skill-tag"><span contenteditable="true">Axure/Sketch</span><button class="delete-tag-btn">Ã—</button></div>
                        <div class="skill-tag"><span contenteditable="true">PMPè®¤è¯</span><button class="delete-tag-btn">Ã—</button></div>
                        <div class="skill-tag"><span contenteditable="true">Google Analytics</span><button class="delete-tag-btn">Ã—</button></div>
                    </div>
                </section>

                <section id="ai-tips">
                    <h2>AIä¼˜åŒ–æç¤º</h2>
                    <div class="ai-tips">
                        <ul>
                            <li id="quant-analysis-tip"><strong>é‡åŒ–æˆæœåˆ†æ</strong>ï¼šæ­£åœ¨åˆ†æ...</li>
                            <li>å…³é”®è¯å·²åŒ…å«ï¼š<strong>ç”¨æˆ·å¢é•¿ã€è½¬åŒ–ç‡æå‡ã€ABå®éªŒã€GMVã€ç•™å­˜ç‡</strong></li>
                            <li>å»ºè®®æŠ•é€’æ—¶å¢åŠ ï¼š<strong>â€œå•†ä¸šåŒ–å˜ç°â€ã€â€œç§åŸŸè¿è¥â€</strong>ç­‰å²—ä½ç›¸å…³æœ¯è¯­</li>
                            <li>ç…§ç‰‡å·²ä¸Šä¼ ï¼š<strong>ä¸“ä¸šå•†åŠ¡ç…§</strong>ï¼ˆç¬¦åˆäºšæ´²ç®€å†è§„èŒƒï¼‰</li>
                            <li>AIæç¤ºå†…å®¹<strong>ä¸ä¼š</strong>å‡ºç°åœ¨æœ€ç»ˆå¯¼å‡ºçš„ç®€å†ä¸­</li>
                        </ul>
                    </div>
                </section>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">æ“ä½œæˆåŠŸ!</span>
    </div>
    
    <input type="file" id="fileInput" accept=".json" style="display: none;">
    
    <script>
        // åˆå§‹åŒ–å˜é‡
        const { jsPDF } = window.jspdf;
        
        // DOMå…ƒç´ 
        const photoUpload = document.getElementById('photoUpload');
        const uploadPhotoBtn = document.getElementById('uploadPhotoBtn');
        const photoPreview = document.getElementById('photoPreview');
        const changePhotoBtn = document.getElementById('changePhotoBtn');
        const removePhotoBtn = document.getElementById('removePhotoBtn');
        const showPhotoCheckbox = document.getElementById('showPhoto');
        const showAiTipsCheckbox = document.getElementById('showAiTips');
        const aiTipsSection = document.getElementById('ai-tips');
        
        // ç…§ç‰‡ä¸Šä¼ åŠŸèƒ½
        uploadPhotoBtn.addEventListener('click', () => photoUpload.click());
        changePhotoBtn.addEventListener('click', () => photoUpload.click());
        photoPreview.addEventListener('click', () => photoUpload.click());
        
        photoUpload.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    photoPreview.style.backgroundImage = `url(${event.target.result})`;
                    photoPreview.innerHTML = '';
                    showPhotoCheckbox.checked = true;
                    saveToLocalStorage();
                    showNotification('ç…§ç‰‡ä¸Šä¼ æˆåŠŸ');
                };
                reader.readAsDataURL(file);
            }
        });
        
        // ç§»é™¤ç…§ç‰‡
        removePhotoBtn.addEventListener('click', function() {
            photoPreview.style.backgroundImage = '';
            photoPreview.innerHTML = `
                <div class="photo-placeholder">
                    <i class="fas fa-user-circle"></i>
                    <p>ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡</p>
                </div>
            `;
            showPhotoCheckbox.checked = false;
            saveToLocalStorage();
            showNotification('ç…§ç‰‡å·²ç§»é™¤');
        });
        
        // æ˜¾ç¤º/éšè—ç…§ç‰‡
        showPhotoCheckbox.addEventListener('change', function() {
            const photoContainer = document.getElementById('photoContainer');
            photoContainer.style.display = this.checked ? 'flex' : 'none';
            saveToLocalStorage();
        });
        
        // æ˜¾ç¤º/éšè—AIæç¤º
        showAiTipsCheckbox.addEventListener('change', function() {
            aiTipsSection.style.display = this.checked ? 'block' : 'none';
            saveToLocalStorage();
        });
        
        // ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½
        document.querySelectorAll('.theme-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                document.body.setAttribute('data-theme', this.dataset.theme);
                saveToLocalStorage();
            });
        });
        
        // é¢œè‰²é€‰æ‹©åŠŸèƒ½
        document.querySelectorAll('.color-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                document.documentElement.style.setProperty('--primary-color', this.dataset.color);
                saveToLocalStorage();
            });
        });
        
        // æ·»åŠ ç»å†
        document.getElementById('addExperience').addEventListener('click', function() {
            const experienceSection = document.getElementById('experience');
            const newExperience = document.createElement('div');
            newExperience.className = 'experience-item';
            newExperience.innerHTML = `
                <button class="delete-btn">Ã—</button>
                <div class="item-header">
                    <div class="company" contenteditable="true">æ–°å…¬å¸åç§°</div>
                    <div class="date" contenteditable="true">YYYYå¹´MMæœˆ - YYYYå¹´MMæœˆ</div>
                </div>
                <div class="position" contenteditable="true">èŒä½åç§°</div>
                <ul>
                    <li contenteditable="true">åœ¨æ­¤æè¿°æ‚¨çš„æˆå°±ï¼Œå°½é‡åŒ…å«é‡åŒ–æ•°æ®ï¼Œå¦‚<span class="highlight">æå‡æ•ˆç‡30%</span></li>
                    <li contenteditable="true">ç¬¬äºŒé¡¹æˆå°±æè¿°...</li>
                </ul>
            `;
            experienceSection.insertBefore(newExperience, this.parentNode.nextSibling);
            attachDeleteEvent(newExperience.querySelector('.delete-btn'));
            saveToLocalStorage();
            showNotification('å·²æ·»åŠ æ–°çš„å·¥ä½œç»å†');
        });
        
        // æ·»åŠ é¡¹ç›®
        document.getElementById('addProject').addEventListener('click', function() {
            const projectSection = document.getElementById('projects');
            const newProject = document.createElement('div');
            newProject.className = 'project-item';
            newProject.innerHTML = `
                <button class="delete-btn">Ã—</button>
                <div class="item-header">
                    <div class="project-name" contenteditable="true">æ–°é¡¹ç›®åç§°</div>
                    <div class="date" contenteditable="true">YYYYå¹´MMæœˆ - YYYYå¹´MMæœˆ</div>
                </div>
                <ul>
                    <li contenteditable="true">åœ¨æ­¤æè¿°é¡¹ç›®æˆæœï¼Œå°½é‡åŒ…å«é‡åŒ–æ•°æ®ï¼Œå¦‚<span class="highlight">æå‡æ•ˆç‡30%</span></li>
                    <li contenteditable="true">ç¬¬äºŒé¡¹æˆæœæè¿°...</li>
                </ul>
            `;
            projectSection.insertBefore(newProject, this.parentNode.nextSibling);
            attachDeleteEvent(newProject.querySelector('.delete-btn'));
            saveToLocalStorage();
            showNotification('å·²æ·»åŠ æ–°çš„é¡¹ç›®');
        });

        // æ·»åŠ æ•™è‚²ç»å†
        document.getElementById('addEducation').addEventListener('click', function() {
            const educationSection = document.getElementById('education');
            const newEducation = document.createElement('div');
            newEducation.className = 'experience-item';
            newEducation.innerHTML = `
                <button class="delete-btn">Ã—</button>
                <div class="item-header">
                    <div class="company" contenteditable="true">å­¦æ ¡åç§°</div>
                    <div class="date" contenteditable="true">YYYYå¹´MMæœˆ - YYYYå¹´MMæœˆ</div>
                </div>
                <div class="position" contenteditable="true">å­¦ä½ Â· ä¸“ä¸š</div>
                <ul>
                    <li contenteditable="true">åœ¨æ­¤æè¿°æ‚¨çš„å­¦æœ¯æˆå°±æˆ–ç›¸å…³è¯¾ç¨‹</li>
                </ul>
            `;
            educationSection.insertBefore(newEducation, this.parentNode.nextSibling);
            attachDeleteEvent(newEducation.querySelector('.delete-btn'));
            saveToLocalStorage();
            showNotification('å·²æ·»åŠ æ–°çš„æ•™è‚²ç»å†');
        });
        
        // æ·»åŠ æŠ€èƒ½
        document.getElementById('addSkill').addEventListener('click', function() {
            const skillsContainer = document.querySelector('.skills-container');
            const newSkill = document.createElement('div');
            newSkill.className = 'skill-tag';
            newSkill.innerHTML = `<span contenteditable="true">æ–°æŠ€èƒ½</span><button class="delete-tag-btn">Ã—</button>`;
            skillsContainer.appendChild(newSkill);
            attachTagDeleteEvent(newSkill.querySelector('.delete-tag-btn'));
            saveToLocalStorage();
            showNotification('å·²æ·»åŠ æ–°æŠ€èƒ½');
        });
        
        // åˆ é™¤åŠŸèƒ½ (é€šç”¨æ¡ç›®)
        function attachDeleteEvent(btn) {
            btn.addEventListener('click', function() {
                this.parentElement.remove();
                saveToLocalStorage();
                showNotification('å·²åˆ é™¤æ¡ç›®');
            });
        }

        // åˆ é™¤åŠŸèƒ½ (æŠ€èƒ½æ ‡ç­¾)
        function attachTagDeleteEvent(btn) {
            btn.addEventListener('click', function(e) {
                e.stopPropagation(); // é˜²æ­¢è§¦å‘çˆ¶å…ƒç´ ç¼–è¾‘
                this.parentElement.remove();
                saveToLocalStorage();
                showNotification('å·²åˆ é™¤æŠ€èƒ½');
            });
        }
        
        // åˆå§‹åŒ–åˆ é™¤æŒ‰é’®äº‹ä»¶
        document.querySelectorAll('.delete-btn').forEach(btn => {
            attachDeleteEvent(btn);
        });

        document.querySelectorAll('.delete-tag-btn').forEach(btn => {
            attachTagDeleteEvent(btn);
        });
        
        // å¯¼å‡ºPDFåŠŸèƒ½
        document.getElementById('exportPdf').addEventListener('click', function() {
            showNotification('æ­£åœ¨ç”ŸæˆPDFï¼Œè¯·ç¨å€™...');
            
            const resumeContainer = document.getElementById('resumeContent');
            const aiTipsSection = document.getElementById('ai-tips');

            // ä¿å­˜åŸå§‹æ ·å¼
            const originalBoxShadow = resumeContainer.style.boxShadow;
            const originalBodyBg = document.body.style.backgroundImage;
            const aiTipsOriginalDisplay = aiTipsSection.style.display;

            // å‡†å¤‡æ¸²æŸ“ç¯å¢ƒï¼šéšè—ä¸å¿…è¦å…ƒç´ ï¼Œç§»é™¤å¹²æ‰°æ ·å¼
            document.querySelectorAll('.add-btn, .delete-btn').forEach(btn => {
                btn.style.visibility = 'hidden';
            });
            aiTipsSection.style.display = 'none';
            resumeContainer.style.boxShadow = 'none';
            document.body.style.backgroundImage = 'none';
            
            const isDarkMode = document.body.getAttribute('data-theme') === 'dark';
            const bgColor = isDarkMode ? '#0f172a' : '#ffffff';
            
            // ä½¿ç”¨html2canvasç”Ÿæˆå›¾ç‰‡
            html2canvas(resumeContainer, {
                scale: 2.3, // æå‡æ¸²æŸ“æ¯”ä¾‹ä»¥è·å¾—æ›´é«˜åˆ†è¾¨ç‡
                useCORS: true,
                logging: false,
                backgroundColor: bgColor,
                // æ ¸å¿ƒä¿®å¤ï¼šè®©canvasçš„é«˜åº¦ç­‰äºå†…å®¹æ»šåŠ¨é«˜åº¦ï¼Œç¡®ä¿æ•æ‰å®Œæ•´å†…å®¹
                height: resumeContainer.scrollHeight,
                windowHeight: resumeContainer.scrollHeight
            }).then(canvas => {
                const contentWidth = canvas.width;
                const contentHeight = canvas.height;
                
                // A4é¡µé¢å°ºå¯¸ (mm)
                const pageHeight_mm = 297;
                const pageWidth_mm = 210;
                
                // å›¾ç‰‡åœ¨PDFä¸­çš„å°ºå¯¸
                const imgWidth_mm = pageWidth_mm;
                const imgHeight_mm = contentHeight * imgWidth_mm / contentWidth;
                
                // è®¡ç®—éœ€è¦å¤šå°‘é¡µ
                let pageCount = Math.ceil(imgHeight_mm / pageHeight_mm);
                pageCount = pageCount < 1 ? 1 : pageCount;

                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgData = canvas.toDataURL('image/png');
                
                // å¤šé¡µæƒ…å†µå¤„ç†
                if (imgHeight_mm <= pageHeight_mm) {
                    pdf.addImage(imgData, 'PNG', 0, 0, imgWidth_mm, imgHeight_mm, undefined, 'FAST');
                } else {
                    let position = 0;
                    for (let i = 0; i < pageCount; i++) {
                        if (i > 0) {
                            pdf.addPage();
                        }
                        // å°†å›¾ç‰‡å‚ç›´åç§»ï¼Œæ˜¾ç¤ºå½“å‰é¡µçš„å†…å®¹
                        pdf.addImage(imgData, 'PNG', 0, -position, imgWidth_mm, imgHeight_mm, undefined, 'FAST');
                        position += pageHeight_mm;
                    }
                }

                pdf.save('ä¸ªäººç®€å†.pdf');
                showNotification(`PDFå¯¼å‡ºæˆåŠŸ (${pageCount}é¡µ)ï¼`);

            }).catch(err => {
                showNotification('PDFç”Ÿæˆå¤±è´¥: ' + err.message);
                console.error("PDF generation failed:", err);

            }).finally(() => {
                // æ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œéƒ½æ¢å¤åŸå§‹çŠ¶æ€
                resumeContainer.style.boxShadow = originalBoxShadow;
                document.body.style.backgroundImage = originalBodyBg;
                document.querySelectorAll('.add-btn, .delete-btn').forEach(btn => {
                    btn.style.visibility = 'visible';
                });
                aiTipsSection.style.display = aiTipsOriginalDisplay;
            });
        });
        
        // æœ¬åœ°ä¿å­˜åŠŸèƒ½
        function saveToLocalStorage() {
            const resumeContent = document.getElementById('resumeContent').innerHTML;
            const color = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
            const theme = document.body.getAttribute('data-theme') || 'light';
            const showPhoto = document.getElementById('showPhoto').checked;
            const showAiTips = document.getElementById('showAiTips').checked;
            const photoPreviewStyle = photoPreview.style.backgroundImage;
            
            const resumeData = {
                content: resumeContent,
                color: color,
                theme: theme,
                showPhoto: showPhoto,
                showAiTips: showAiTips,
                photoPreview: photoPreviewStyle
            };
            
            localStorage.setItem('resumeData', JSON.stringify(resumeData));
        }
        
        // è‡ªåŠ¨ä¿å­˜
        document.addEventListener('input', function(e) {
            // ä¿®å¤ï¼šè‡ªåŠ¨ç§»é™¤ç©ºçš„åˆ—è¡¨é¡¹
            if (e.target.tagName === 'LI' && e.target.textContent.trim() === '') {
                // å»¶è¿Ÿç§»é™¤ï¼Œä»¥é˜²ç”¨æˆ·åªæ˜¯æƒ³é‡æ–°è¾“å…¥
                setTimeout(() => {
                    if (e.target && e.target.textContent.trim() === '') {
                        e.target.remove();
                    }
                }, 1500);
            }
            analyzeResume(); // å®æ—¶åˆ†æ
            saveToLocalStorage();
        });

        // AIç®€å†åˆ†æåŠŸèƒ½
        function analyzeResume() {
            const quantTipElement = document.getElementById('quant-analysis-tip');
            if (!quantTipElement) return;

            // 1. é‡åŒ–æˆæœåˆ†æ
            const listItems = document.querySelectorAll('#experience li, #education li, #projects li');
            const totalItems = listItems.length;
            let quantifiedItems = 0;

            const quantRegex = /\d|%/; // åŒ¹é…ä»»ä½•æ•°å­—æˆ–ç™¾åˆ†å·

            listItems.forEach(item => {
                if (quantRegex.test(item.textContent)) {
                    quantifiedItems++;
                }
            });

            let quantMessage = '<strong>é‡åŒ–æˆæœåˆ†æ</strong>ï¼šæš‚æ— æè¿°å¯åˆ†æã€‚';
            if (totalItems > 0) {
                const percentage = Math.round((quantifiedItems / totalItems) * 100);
                quantMessage = `<strong>é‡åŒ–æˆæœåˆ†æ</strong>ï¼šæ‚¨çš„ç®€å†ä¸­ï¼Œæœ‰ <strong>${quantifiedItems}/${totalItems}</strong> ä¸ªæè¿°ç‚¹åŒ…å«å…·ä½“æ•°æ®ï¼Œå æ¯” <strong>${percentage}%</strong>ã€‚`;
                if (percentage < 50) {
                    quantMessage += ' å»ºè®®å¢åŠ æ›´å¤šé‡åŒ–æˆæœï¼';
                } else {
                    quantMessage += ' éå¸¸å‡ºè‰²ï¼';
                }
            }
            quantTipElement.innerHTML = quantMessage;
        }
        
        // åŠ è½½æœ¬åœ°å­˜å‚¨
        
        // åŠ è½½æœ¬åœ°å­˜å‚¨
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('resumeData');
            if (savedData) {
                const data = JSON.parse(savedData);
                document.getElementById('resumeContent').innerHTML = data.content;
                document.documentElement.style.setProperty('--primary-color', data.color);
                document.body.setAttribute('data-theme', data.theme);
                document.getElementById('showPhoto').checked = data.showPhoto;
                document.getElementById('showAiTips').checked = data.showAiTips;
                
                // ä¿®å¤ï¼šåœ¨é‡æ–°æ¸²æŸ“DOMåï¼Œå†æ¬¡è·å–å…ƒç´ å¹¶åº”ç”¨æ ·å¼
                const currentPhotoPreview = document.getElementById('photoPreview');
                if (currentPhotoPreview) {
                    currentPhotoPreview.style.backgroundImage = data.photoPreview;
                    if (data.photoPreview) {
                        currentPhotoPreview.innerHTML = '';
                    }
                    // ä¿®å¤ï¼šä¸ºæ–°åŠ è½½çš„ç…§ç‰‡åŒºåŸŸé‡æ–°ç»‘å®šç‚¹å‡»äº‹ä»¶
                    currentPhotoPreview.addEventListener('click', () => photoUpload.click());
                }
                
                const photoContainer = document.getElementById('photoContainer');
                if(photoContainer) photoContainer.style.display = data.showPhoto ? 'flex' : 'none';
                
                const aiTipsSection = document.getElementById('ai-tips');
                if(aiTipsSection) aiTipsSection.style.display = data.showAiTips ? 'block' : 'none';
                
                // æ›´æ–°UIçŠ¶æ€
                document.querySelectorAll('.color-option').forEach(option => {
                    option.classList.toggle('active', option.dataset.color === data.color);
                });
                
                document.querySelectorAll('.theme-btn').forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.theme === data.theme);
                });
                
                // é‡æ–°ç»‘å®šåˆ é™¤äº‹ä»¶
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    attachDeleteEvent(btn);
                });
                document.querySelectorAll('.delete-tag-btn').forEach(btn => {
                    attachTagDeleteEvent(btn);
                });
                
                showNotification('å·²åŠ è½½æœ¬åœ°ä¿å­˜çš„ç®€å†');
            }
        }
        
        // æ‰‹åŠ¨ä¿å­˜åˆ°æœ¬åœ°
        document.getElementById('saveLocal').addEventListener('click', function() {
            saveToLocalStorage();
            showNotification('ç®€å†å·²ä¿å­˜åˆ°æµè§ˆå™¨æœ¬åœ°å­˜å‚¨');
        });
        
        // ä»æœ¬åœ°åŠ è½½
        document.getElementById('loadLocal').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });

        // é‡ç½®ä¸ºæ¨¡æ¿
        document.getElementById('resetTemplate').addEventListener('click', function() {
            if (confirm('ç¡®å®šè¦é‡ç½®ä¸ºåŸå§‹æ¨¡æ¿å—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰å·²ç¼–è¾‘å’Œä¿å­˜çš„å†…å®¹ã€‚')) {
                localStorage.removeItem('resumeData');
                window.location.reload();
            }
        });

        // æ™ºèƒ½åŒ¹é…å²—ä½åŠŸèƒ½
        document.getElementById('matchJobsBtn').addEventListener('click', function() {
            // 1. å®šä¹‰åŸå¸‚ä»£ç 
            const cityCodes = {
                'zhipin': {
                    'åŒ—äº¬': '101010100', 'ä¸Šæµ·': '101020100', 'å¹¿å·': '101280100', 'æ·±åœ³': '101280600', 'æ­å·': '101210100',
                    'æˆéƒ½': '101270100', 'é‡åº†': '101040100', 'æ­¦æ±‰': '101200100', 'è¥¿å®‰': '101110100', 'å—äº¬': '101190400'
                },
                'liepin': {
                    'åŒ—äº¬': '010', 'ä¸Šæµ·': '020', 'å¹¿å·': '050020', 'æ·±åœ³': '050090', 'æ­å·': '070020',
                    'æˆéƒ½': '280020', 'é‡åº†': '040', 'æ­¦æ±‰': '170020', 'è¥¿å®‰': '270020', 'å—äº¬': '060020'
                }
            };

            // 2. ä»ç®€å†æå–ä¿¡æ¯
            const jobTitleElement = document.querySelector('.job-title');
            const locationElement = document.querySelector('.contact-item:nth-child(3)');
            if (!jobTitleElement || !locationElement) {
                showNotification('ç®€å†ä¿¡æ¯ä¸å®Œæ•´ï¼Œæ— æ³•åŒ¹é…');
                return;
            }
            const jobTitle = jobTitleElement.textContent.trim().split('|')[0].trim();
            const locationText = locationElement.textContent.trim();
            const skills = Array.from(document.querySelectorAll('.skill-tag span')).map(s => s.textContent.trim());

            let city = '';
            for (const cityName in cityCodes.zhipin) {
                if (locationText.includes(cityName)) {
                    city = cityName;
                    break;
                }
            }

            if (!jobTitle) {
                showNotification('è¯·å…ˆå¡«å†™èŒä½åç§°');
                return;
            }

            // 3. æ„å»ºæŸ¥è¯¢URL
            const queryKeywords = [jobTitle, ...skills.slice(0, 2)];
            const encodedQuery = encodeURIComponent(queryKeywords.join(' '));

            const zhipinCityCode = city ? cityCodes.zhipin[city] : '';
            const liepinCityCode = city ? cityCodes.liepin[city] : '';

            const zhipinUrl = `https://www.zhipin.com/web/geek/job?query=${encodedQuery}${zhipinCityCode ? '&city=' + zhipinCityCode : ''}`;
            const liepinUrl = `https://www.liepin.com/zhaopin/?key=${encodedQuery}${liepinCityCode ? '&city=' + liepinCityCode : ''}`;

            // 4. æ˜¾ç¤ºç»“æœé¢æ¿
            document.getElementById('zhipinLink').href = zhipinUrl;
            document.getElementById('liepinLink').href = liepinUrl;
            document.getElementById('jobMatchResults').style.display = 'block';
            showNotification('åŒ¹é…é“¾æ¥å·²ç”Ÿæˆï¼');
        });

        // å…³é—­åŒ¹é…ç»“æœé¢æ¿
        document.getElementById('closeMatchResults').addEventListener('click', function() {
            document.getElementById('jobMatchResults').style.display = 'none';
        });
        
        // æ–‡ä»¶å¯¼å…¥åŠŸèƒ½
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const data = JSON.parse(event.target.result);
                    document.getElementById('resumeContent').innerHTML = data.content;
                    document.documentElement.style.setProperty('--primary-color', data.color);
                    document.body.setAttribute('data-theme', data.theme);
                    document.getElementById('showPhoto').checked = data.showPhoto;
                    document.getElementById('showAiTips').checked = data.showAiTips;
                    
                    // ä¿®å¤ï¼šåœ¨é‡æ–°æ¸²æŸ“DOMåï¼Œå†æ¬¡è·å–å…ƒç´ å¹¶åº”ç”¨æ ·å¼
                    const currentPhotoPreview = document.getElementById('photoPreview');
                    if (currentPhotoPreview) {
                        currentPhotoPreview.style.backgroundImage = data.photoPreview;
                        if (data.photoPreview) {
                            currentPhotoPreview.innerHTML = '';
                        }
                        // ä¿®å¤ï¼šä¸ºæ–°åŠ è½½çš„ç…§ç‰‡åŒºåŸŸé‡æ–°ç»‘å®šç‚¹å‡»äº‹ä»¶
                        currentPhotoPreview.addEventListener('click', () => photoUpload.click());
                    }

                    const photoContainer = document.getElementById('photoContainer');
                    if(photoContainer) photoContainer.style.display = data.showPhoto ? 'flex' : 'none';
                    
                    const aiTipsSection = document.getElementById('ai-tips');
                    if(aiTipsSection) aiTipsSection.style.display = data.showAiTips ? 'block' : 'none';
                    
                    // æ›´æ–°UIçŠ¶æ€
                    document.querySelectorAll('.color-option').forEach(option => {
                        option.classList.toggle('active', option.dataset.color === data.color);
                    });
                    
                    document.querySelectorAll('.theme-btn').forEach(btn => {
                        btn.classList.toggle('active', btn.dataset.theme === data.theme);
                    });
                    
                    // é‡æ–°ç»‘å®šåˆ é™¤äº‹ä»¶
                    document.querySelectorAll('.delete-btn').forEach(btn => {
                        attachDeleteEvent(btn);
                    });
                    document.querySelectorAll('.delete-tag-btn').forEach(btn => {
                        attachTagDeleteEvent(btn);
                    });
                    
                    showNotification('ç®€å†å¯¼å…¥æˆåŠŸï¼');
                } catch (error) {
                    showNotification('æ–‡ä»¶æ ¼å¼é”™è¯¯ï¼Œå¯¼å…¥å¤±è´¥');
                    console.error(error);
                }
            };
            reader.readAsText(file);
        });
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(text) {
            const notification = document.getElementById('notification');
            const textElement = document.getElementById('notificationText');
            
            textElement.textContent = text;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // åˆå§‹åŒ–åŠ è½½
        window.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            analyzeResume(); // é¡µé¢åŠ è½½åç«‹å³åˆ†æä¸€æ¬¡
            
            // é«˜äº®é‡åŒ–æ•°æ®
            document.querySelectorAll('li').forEach(li => {
                li.innerHTML = li.innerHTML.replace(/(\d+%|\d+ä¸‡|\d+\.\d+äº¿|\d+ä¸‡)/g, 
                    '<span style="color:var(--primary-color);font-weight:bold">$1</span>'
                );
            });
        });
    </script>
</body>
</html>